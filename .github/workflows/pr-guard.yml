name: PR Guardrails

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

jobs:
  validate:
    runs-on: ubuntu-latest    
    
    steps:
      - name: Validate PR title (Conventional Commits style)
        uses: amannn/action-semantic-pull-request@v5
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:  
          types: ["feat", "fix", "docs", "style", "refactor", "perf", "test", "chore", "ci"]
          requireScope: false

      - name: Validate branch name  
        run: |
          BRANCH="${{ github.head_ref }}"
          echo "Branch: $BRANCH"
          # Example rule: feature/xxx, fix/xxx, chore/xxx
          if [[ ! "$BRANCH" =~ ^(feature|fix|chore|docs|refactor|test|ci)\/[a-z0-9._-]+$ ]]; then
            echo "Invalid branch name: $BRANCH"
            echo "Use: feature/my-branch OR fix/bug-123 etc."
            exit 1
          fi

